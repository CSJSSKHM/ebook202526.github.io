<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>楊修之死 - AI文言故事漫畫創作</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <style>
        /* =========================================
           LAYER 1: 環境層 (Cyberpunk City Background)
           ========================================= */
        body, html {
            margin: 0; padding: 0; height: 100%; overflow: hidden;
            background-color: #020408;
            font-family: 'Share Tech Mono', monospace;
        }

        .cyber-environment {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            /* 使用一個 Cyberpunk 城市背景圖 (這裡用 Unsplash 的圖做範例) */
            background: url('https://images.unsplash.com/photo-1579573808890-d33170312b00?q=80&w=2070&auto=format&fit=crop') no-repeat center center/cover;
            display: flex; justify-content: center; align-items: center;
        }
        
        /* 環境暗化與霓虹濾鏡 */
        .cyber-environment::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(5, 10, 20, 0.8); /* 壓暗背景 */
            /* 添加藍紫色的氛圍光 */
            box-shadow: inset 0 0 200px rgba(0, 243, 255, 0.3), inset 0 0 100px rgba(188, 19, 254, 0.3);
            pointer-events: none;
        }

        /* =========================================
           LAYER 2: 硬體層 (The TV Terminal Frame)
           ========================================= */
        .terminal-unit {
            position: relative;
            width: 85%; max-width: 1400px;
            height: 80%; max-height: 900px;
            background: #1a1a1d; /* 機殼顏色 */
            border: 4px solid #333;
            /* 工業風外殼造型 (切角 + 邊框) */
            clip-path: polygon(
                0 20px, 20px 0, calc(100% - 20px) 0, 100% 20px, 
                100% calc(100% - 20px), calc(100% - 20px) 100%, 20px 100%, 0 calc(100% - 20px)
            );
            /* 霓虹發光邊緣 */
            box-shadow: 
                0 0 0 4px #000, /* 內圈黑邊 */
                0 0 30px rgba(0, 243, 255, 0.5), /* 青色光暈 */
                0 0 60px rgba(188, 19, 254, 0.3), /* 紫色光暈 */
                inset 0 0 20px rgba(0, 0, 0, 0.8); /* 內部陰影增加厚度感 */
            padding: 30px; /* 螢幕邊框厚度 */
            display: flex; flex-direction: column;
            z-index: 10;
        }

        /* 裝飾：機殼上的鉚釘/細節 */
        .terminal-unit::after {
            content: 'MODEL: CSJ-CHIN X STEM // SN: 2025-2026 V1.0';
            position: absolute; bottom: 5px; right: 30px;
            color: rgba(0, 243, 255, 0.5); font-size: 0.7rem; letter-spacing: 1px;
        }

        /* =========================================
           LAYER 3: 螢幕層 (The Screen & CRT Effects)
           ========================================= */
        .screen-container {
            position: relative;
            width: 100%; height: 100%;
            background: #050a10; /* 螢幕未開啟時的底色 */
            overflow: hidden; /* 關鍵：內容不能跑出螢幕 */
            border: 2px solid rgba(0, 243, 255, 0.2);
            box-shadow: inset 0 0 30px rgba(0,0,0,0.8);
        }

        /* CRT 掃描線與螢幕反光濾鏡 */
        .crt-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 999;
            /* 1. 細微的掃描橫線 */
            background: repeating-linear-gradient(
                to bottom, transparent 0px, transparent 2px, rgba(0, 0, 0, 0.2) 3px
            );
            /* 2. 螢幕曲面暗角效果 (Vignette) */
            box-shadow: inset 0 0 80px rgba(0,0,0,0.7);
        }
        /* 螢幕閃爍動畫 */
        .crt-overlay::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 243, 255, 0.03);
            animation: flicker 0.15s infinite; pointer-events: none;
        }
        @keyframes flicker {
            0% { opacity: 0.8; } 50% { opacity: 1; } 100% { opacity: 0.9; }
        }

        /* 內容捲動容器 */
        .screen-content-scroll {
            height: 100%; overflow-y: auto;
            /* 自定義螢幕內的滾動條 */
            scrollbar-width: thin; scrollbar-color: var(--neon-cyan) #000;
        }
        .screen-content-scroll::-webkit-scrollbar { width: 8px; background: #000; }
        .screen-content-scroll::-webkit-scrollbar-thumb { background: var(--neon-cyan); border-radius: 4px; }


        /* =========================================
           LAYER 4: 內容層 (The Previous 2B System)
           以下是上一個版本的 CSS，稍作調整以適應螢幕內部
           ========================================= */
        :root {
            --neon-cyan: #00f3ff;
            --border-color: rgba(0, 243, 255, 0.3);
            --text-main: #e0f7fa;
        }

        /* 標題區調整 (變小一點適應螢幕) */
        .inner-header {
            padding: 25px; text-align: center;
            border-bottom: 1px solid var(--border-color);
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
            position: relative;
        }
        .inner-header h1 {
            font-family: 'Orbitron'; font-size: 2.2rem; color: #fff; margin: 0;
            text-shadow: 0 0 10px var(--neon-cyan); letter-spacing: 3px;
        }
        .sys-status { font-size: 0.8rem; color: var(--neon-cyan); margin-top: 5px; opacity: 0.8; }

        /* Grid 與 卡片 (保持不變) */
        .grid-container {
            padding: 25px;
            display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px; 
        }
        .book-card {
            position: relative; background: rgba(10, 20, 30, 0.6);
            border: 1px solid var(--border-color); padding: 8px; cursor: pointer; transition: all 0.3s ease;
            clip-path: polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);
        }
        .book-card:hover {
            transform: translateY(-3px); background: rgba(0, 243, 255, 0.1);
            border-color: var(--neon-cyan); box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
        }
        .cover-wrapper { width: 100%; aspect-ratio: 3/4; overflow: hidden; margin-bottom: 8px; border: 1px solid rgba(255,255,255,0.1); }
        .book-img { width: 100%; height: 100%; object-fit: cover; filter: grayscale(40%) contrast(1.1); transition: 0.4s; }
        .book-card:hover .book-img { filter: grayscale(0%) contrast(1); }
        .card-info { text-align: left; padding-left: 5px; }
        .book-title { font-family: 'Orbitron'; font-size: 0.8rem; font-weight: 700; color: #fff; margin: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .book-meta { font-size: 0.7rem; color: var(--neon-cyan); margin-top: 2px; display: flex; justify-content: space-between; }

        /* --- 關鍵修改：閱讀器現在是 absolute 而不是 fixed --- */
        .reader-overlay {
            position: absolute; /* 變更點：限制在父容器內 */
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(5, 10, 16, 0.98);
            backdrop-filter: blur(5px); z-index: 100; /* Z-index 調整 */
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: 0.3s;
            background-image: radial-gradient(circle, transparent 20%, #000 120%);
        }
        .reader-overlay.active { opacity: 1; pointer-events: auto; }

        /* 閱讀器內部元件 (保持不變) */
        .reader-stage {
            position: relative; width: 100%; height: 80%;
            display: flex; justify-content: center; align-items: center;
        }
        .tv-screen-anim { /* 改個名避免衝突 */
            position: relative; max-width: 95%; max-height: 100%;
            display: flex; justify-content: center; align-items: center; transform-origin: center center;
        }
        .reader-img-display {
            max-width: 100%; max-height: 85vh;
            border: 1px solid var(--neon-cyan); box-shadow: 0 0 30px rgba(0, 243, 255, 0.15);
        }
        /* CRT Animation Keyframes (保持不變) */
        @keyframes turn-off {
            0% { transform: scale(1, 1); filter: brightness(1) contrast(1); opacity: 1; }
            40% { transform: scale(1, 0.005); filter: brightness(5) contrast(2); opacity: 1; }
            70% { transform: scale(0.005, 0.005); filter: brightness(20); opacity: 1; }
            100% { transform: scale(0, 0); filter: brightness(0); opacity: 0; }
        }
        @keyframes turn-on {
            0% { transform: scale(0.005, 0); filter: brightness(20); opacity: 0; }
            30% { transform: scale(0.005, 0.005); filter: brightness(10); opacity: 1; }
            60% { transform: scale(1, 0.005); filter: brightness(5); opacity: 1; }
            100% { transform: scale(1, 1); filter: brightness(1) contrast(1); opacity: 1; }
        }
        .anim-off { animation: turn-off 0.35s cubic-bezier(0.23, 1, 0.32, 1) forwards; }
        .anim-on { animation: turn-on 0.45s cubic-bezier(0.23, 1, 0.32, 1) forwards; }

        /* UI Buttons */
        .nav-btn {
            position: absolute; top: 50%; transform: translateY(-50%); width: 40px; height: 70px;
            background: rgba(0, 0, 0, 0.5); border: 1px solid var(--neon-cyan); color: var(--neon-cyan);
            font-size: 1.5rem; display: flex; justify-content: center; align-items: center; cursor: pointer; z-index: 10; transition: 0.2s;
            clip-path: polygon(0 10%, 100% 0, 100% 90%, 0 100%);
        }
        .nav-btn:hover { background: var(--neon-cyan); color: #000; box-shadow: 0 0 15px var(--neon-cyan); }
        .prev-btn { left: 10px; } .next-btn { right: 10px; }
        .close-btn {
            position: absolute; top: 15px; right: 15px; font-family: 'Orbitron'; color: #ff3333;
            font-size: 1rem; cursor: pointer; border: 1px solid #ff3333; padding: 5px 12px;
            transition: 0.3s;
        }
        .close-btn:hover { background: #ff3333; color: #000; }
        .progress-bar-container { position: absolute; bottom: 0; width: 100%; height: 3px; background: #111; }
        .progress-bar { height: 100%; background: var(--neon-cyan); width: 0%; box-shadow: 0 0 10px var(--neon-cyan); transition: width 0.2s; }
        .page-data { position: absolute; bottom: 15px; right: 20px; font-family: 'Orbitron'; color: var(--neon-cyan); font-size: 1rem; }

    </style>
</head>
<body>

<div class="cyber-environment">
    
    <div class="terminal-unit">
        
        <div class="screen-container">
            <div class="crt-overlay"></div>

            <div class="screen-content-scroll">
                
                <div class="inner-header">
                    <h1>楊修之死 - AI文言故事漫畫創作</h1>
                    <div class="sys-status">TERMINAL LINK: ESTABLISHED // READY</div>
                </div>

                <div class="grid-container" id="bookGrid"></div>
                </div> <div class="reader-overlay" id="readerOverlay">
                <div class="close-btn" onclick="closeBook()">[ X ]</div>
                
                <div class="reader-stage">
                    <div class="nav-btn prev-btn" onclick="changePage(-1)">❮</div>
                    <div class="tv-screen-anim" id="tvScreenAnim">
                        <img src="" class="reader-img-display" id="readerImg">
                    </div>
                    <div class="nav-btn next-btn" onclick="changePage(1)">❯</div>
                </div>

                <div class="page-data" id="pageInfo">00 / 00</div>
                <div class="progress-bar-container"><div class="progress-bar" id="progressBar"></div></div>
            </div>

        </div> </div> </div>

<script>
    // ==========================================
    // 資料與邏輯 (與上一版完全相同)
    // ==========================================
    const rootFolder = '2B'; 
    const bookData = [
        { folder: '2B第1組', title: '2B第1組', count: 13 },
        { folder: '2B第2組', title: '2B第2組', count: 12 },
        { folder: 'gp3', title: 'PROJECT-03', count: 8 },
        { folder: 'gp1', title: 'DATA-LOG 04', count: 5 },
        { folder: 'gp2', title: 'DATA-LOG 05', count: 12 },
    ];

    const grid = document.getElementById('bookGrid');
    bookData.forEach((item, idx) => {
        const coverPath = `${rootFolder}/${item.folder}/b.png`;
        const pages = [];
        for (let i = 1; i <= item.count; i++) pages.push(`${rootFolder}/${item.folder}/${i}.png`);
        const idStr = (idx + 1).toString().padStart(3, '0');
        const card = document.createElement('div');
        card.className = 'book-card';
        card.onclick = () => openBook(pages);
        card.innerHTML = `
            <div class="cover-wrapper"><img src="${coverPath}" class="book-img" loading="lazy" alt="${item.title}" onerror="this.src='${pages[0] || ''}'"></div>
            <div class="card-info"><h3 class="book-title">${item.title}</h3><div class="book-meta"><span>ID:${idStr}</span><span>SIZE:${item.count}</span></div></div>
        `;
        grid.appendChild(card);
    });

    let currentPages = []; let currentIndex = 0; let isTransitioning = false;
    const overlay = document.getElementById('readerOverlay');
    const readerImg = document.getElementById('readerImg');
    const tvScreenAnim = document.getElementById('tvScreenAnim'); // 改了ID
    const pageInfo = document.getElementById('pageInfo');
    const progressBar = document.getElementById('progressBar');
    const prevBtn = document.querySelector('.prev-btn');
    const nextBtn = document.querySelector('.next-btn');

    function openBook(pages) {
        if (!pages.length) return;
        currentPages = pages; currentIndex = 0;
        overlay.classList.add('active');
        loadPage(currentIndex);
        triggerAnimation('on');
    }

    function closeBook() {
        triggerAnimation('off');
        setTimeout(() => {
            overlay.classList.remove('active');
            readerImg.src = '';
            tvScreenAnim.classList.remove('anim-off', 'anim-on');
        }, 400);
    }

    function changePage(dir) {
        if (isTransitioning) return;
        const nextIndex = currentIndex + dir;
        if (nextIndex >= 0 && nextIndex < currentPages.length) {
            isTransitioning = true;
            triggerAnimation('off');
            setTimeout(() => {
                currentIndex = nextIndex;
                const tempImg = new Image();
                tempImg.src = currentPages[currentIndex];
                tempImg.onload = () => {
                    readerImg.src = tempImg.src;
                    updateControls();
                    triggerAnimation('on');
                    setTimeout(() => { isTransitioning = false; }, 500);
                };
            }, 350);
        }
    }

    function triggerAnimation(type) {
        tvScreenAnim.classList.remove('anim-on', 'anim-off');
        void tvScreenAnim.offsetWidth; 
        tvScreenAnim.classList.add(type === 'on' ? 'anim-on' : 'anim-off');
    }

    function loadPage(index) {
        currentIndex = index;
        readerImg.src = currentPages[index];
        updateControls();
    }

    function updateControls() {
        pageInfo.innerText = `${(currentIndex + 1).toString().padStart(2, '0')} / ${currentPages.length.toString().padStart(2, '0')}`;
        progressBar.style.width = `${((currentIndex + 1) / currentPages.length) * 100}%`;
        prevBtn.style.visibility = currentIndex === 0 ? 'hidden' : 'visible';
        nextBtn.style.visibility = currentIndex === currentPages.length - 1 ? 'hidden' : 'visible';
    }
</script>

</body>
</html>


